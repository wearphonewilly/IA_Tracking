<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="robots" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar Query - Medici√≥n de IAs</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <meta name="robots" content="noindex, nofollow">
</head>

<body>
    <div class="app-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="logo-icon">‚óé</span>
                    <span class="logo-text">AI Tracker</span>
                </div>
            </div>

            <nav class="sidebar-nav">
                <a href="/" class="nav-item">
                    <span class="icon">‚äû</span> Dashboard
                </a>
                <a href="/queries" class="nav-item">
                    <span class="icon">üìÇ</span> Queries
                </a>
                <a href="#" class="nav-item">
                    <span class="icon">‚öô</span> Configuration
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="user-profile">
                    <div class="avatar">AM</div>
                    <div class="user-info">
                        <div class="user-name">Alex Morgan</div>
                        <div class="user-role">Enterprise Admin</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="top-header">
                <div class="header-left">
                    <div class="breadcrumbs"
                        style="color:var(--text-secondary); margin-bottom:0.5rem; font-size:0.875rem;">
                        <span onclick="goBack()"
                            style="cursor:pointer; display:inline-flex; align-items:center; gap:0.25rem;">‚Üê
                            Queries</span> ‚Ä∫ Create Configuration
                    </div>
                    <h1>Create Query Configuration</h1>
                    <p class="subtitle">Configure your brand monitoring parameters and select AI models to track.</p>
                </div>
            </header>

            <!-- Form -->
            <form id="query-form" class="query-form" style="max-width: 100%;">

                <!-- 1. Basic Info -->
                <section class="form-section">
                    <div style="display:flex; align-items:center; gap:0.5rem; margin-bottom:1.5rem;">
                        <span class="step-badge"
                            style="background:var(--primary-color); color:white; width:24px; height:24px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:14px; font-weight:600;">1</span>
                        <h2 style="margin:0;">Basic Info</h2>
                    </div>

                    <div class="form-group">
                        <label for="query-name">Query Group Name *</label>
                        <input type="text" id="query-name" name="name"
                            placeholder="e.g. Q3 Brand Monitoring - North America" required>
                    </div>

                    <div class="form-group">
                        <label>Target Keywords / Brands *</label>
                        <div class="keyword-input-group">
                            <input type="text" id="keyword-input" placeholder="Type and press Enter...">
                            <button type="button" class="btn btn-secondary" onclick="addKeyword()">Add</button>
                        </div>
                        <div id="keywords-container" class="keywords-container"></div>
                        <small>These keywords will be injected into your prompts where {keyword} is used.</small>
                    </div>

                    <div class="form-group">
                        <label>Competitors</label>
                        <div class="keyword-input-group">
                            <input type="text" id="competitor-input"
                                placeholder="Type competitor name and press Enter...">
                            <button type="button" class="btn btn-secondary" onclick="addCompetitor()">Add</button>
                        </div>
                        <div id="competitors-container" class="keywords-container"></div>
                    </div>
                </section>

                <!-- 2. Prompts -->
                <section class="form-section">
                    <div style="display:flex; align-items:center; gap:0.5rem; margin-bottom:1.5rem;">
                        <span class="step-badge"
                            style="background:var(--primary-color); color:white; width:24px; height:24px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:14px; font-weight:600;">2</span>
                        <h2 style="margin:0;">Prompt Template</h2>
                    </div>

                    <div class="form-group">
                        <label>Prompt Text</label>
                        <textarea id="prompt-text"
                            placeholder="Analyze the sentiment of the following brand: {keyword}. Provide a summary of its strengths and weaknesses."></textarea>
                        <div style="display:flex; justify-content:space-between; margin-top:0.5rem;">
                            <small>Use <span class="code-badge"
                                    style="background:#e0e7ff; color:#3b82f6; padding:2px 6px; border-radius:4px;">{keyword}</span>
                                as a placeholder variable.</small>
                        </div>
                    </div>
                </section>

                <!-- 3. AI Models -->
                <section class="form-section">
                    <div style="display:flex; align-items:center; gap:0.5rem; margin-bottom:1.5rem;">
                        <span class="step-badge"
                            style="background:var(--primary-color); color:white; width:24px; height:24px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:14px; font-weight:600;">3</span>
                        <h2 style="margin:0;">AI Models</h2>
                    </div>
                    <div id="models-container" class="models-grid"
                        style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem;">
                        <!-- JS injected -->
                    </div>
                </section>

                <!-- Footer Actions -->
                <div class="form-footer"
                    style="display: flex; justify-content: flex-end; gap: 1rem; padding: 2rem 0; background: var(--bg-color); position: sticky; bottom: 0; border-top: 1px solid var(--border-color); margin-top: 2rem;">
                    <button type="button" class="btn btn-secondary" onclick="goBack()"
                        style="background:white;">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Query</button>
                </div>
            </form>
        </main>
    </div>

    <script>
        const queryId = new URLSearchParams(window.location.search).get('id');
    </script>
    <script src="{{ url_for('static', filename='js/edit_query.js') }}"></script>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "{{ firebase_api_key }}",
            authDomain: "ia-tracking-28e46.firebaseapp.com",
            projectId: "ia-tracking-28e46",
            storageBucket: "ia-tracking-28e46.firebasestorage.app",
            messagingSenderId: "73826798267",
            appId: "1:73826798267:web:c7ed99528f80f3daaef79e",
            measurementId: "G-M3FZW3BJF4"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
    </script>
</body>

</html>